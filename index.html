<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="(ì£¼)ë¯¸ì§„í™”ì¥í’ˆ - ì‹œíŠ¸ ë§ˆìŠ¤í¬íŒ© ì œì¡° ë° íŒë§¤, OEM/ODM ì „ë¬¸ê¸°ì—…">
    <meta name="keywords" content="MIJIN,COSMETICS">
    <title>MIJIN COSMETICS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
        }

        /* Header */
        header {
            background: #fff;
            padding: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #000;
            text-decoration: none;
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 30px;
        }

        nav a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
        }

        nav a:hover {
            color: #fe6b00;
        }

        /* Hero Slider */
        .hero-slider {
            position: relative;
            height: 600px;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
        }

        .hero-content h1 {
            font-size: 48px;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .hero-content h2 {
            font-size: 36px;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .hero-content p {
            font-size: 18px;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        /* Section Styles */
        section {
            padding: 80px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            font-size: 42px;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .section-subtitle {
            font-size: 20px;
            text-align: center;
            margin-bottom: 50px;
            color: #666;
        }

        .section-content {
            text-align: center;
        }

        .section-content h3 {
            font-size: 32px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .section-content p {
            font-size: 18px;
            color: #666;
            margin-bottom: 10px;
        }

        .btn-more {
            display: inline-block;
            margin-top: 30px;
            padding: 12px 30px;
            background: #fe6b00;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s;
        }

        .btn-more:hover {
            background: #d85a00;
        }

        /* About Section */
        .about-section {
            background: #f8f9fa;
        }

        /* Solutions Section */
        .solutions-section {
            background: #fff;
        }

        .solutions-content {
            text-align: center;
            padding: 40px 0;
        }

        .solutions-content hr {
            width: 100px;
            margin: 30px auto;
            border: none;
            border-top: 2px solid #fe6b00;
        }

        .certification {
            font-size: 24px;
            margin: 20px 0;
        }

        .certification strong {
            color: #fe6b00;
        }

        /* Products Section */
        .products-section {
            background: #f8f9fa;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .product-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .product-image {
            width: 100%;
            height: 300px;
            background: #e9ecef;
            display: block;
            object-fit: cover;
            color: #999;
            font-size: 14px;
        }

        .product-info {
            padding: 20px;
        }

        .product-info h3 {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .product-badge {
            display: inline-block;
            background: #fe6b00;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .product-price {
            font-size: 20px;
            font-weight: bold;
            color: #fe6b00;
        }

        .product-upload {
            margin-top: 60px;
            padding: 30px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .product-upload h3 {
            font-size: 20px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .product-upload form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            align-items: end;
        }

        .product-upload label {
            display: flex;
            flex-direction: column;
            font-size: 14px;
            color: #555;
            gap: 8px;
        }

        .product-upload input[type="text"],
        .product-upload input[type="number"],
        .product-upload input[type="file"] {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .product-upload button {
            padding: 12px 20px;
            background: #fe6b00;
            color: #fff;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .product-upload button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .product-upload button:hover:not(:disabled) {
            background: #d85a00;
        }

        .product-admin {
            margin-top: 40px;
            padding: 30px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .product-admin h3 {
            font-size: 20px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .product-admin-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .product-admin-row {
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .product-admin-row strong {
            min-width: 200px;
            font-size: 14px;
        }

        .product-admin-row input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            flex: 1 1 180px;
        }

        .product-admin-row button {
            padding: 8px 14px;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            cursor: pointer;
        }

        .btn-save-meta {
            background: #2c3e50;
            color: #fff;
        }

        .btn-delete {
            background: #fe6b00;
            color: #fff;
        }

        .product-actions {
            text-align: center;
            margin-top: 50px;
        }

        .product-admin-toggle {
            padding: 14px 38px;
            background: #2c3e50;
            color: #fff;
            font-size: 16px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s, background 0.3s;
            box-shadow: 0 8px 20px rgba(44, 62, 80, 0.25);
        }

        .product-admin-toggle:hover {
            background: #1f2c3a;
            transform: translateY(-1px);
        }

        .product-admin-toggle:focus {
            outline: 3px solid rgba(254, 107, 0, 0.4);
            outline-offset: 3px;
        }

        .product-modal {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px;
            background: rgba(0, 0, 0, 0.55);
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease;
        }

        .product-modal.is-active {
            opacity: 1;
            pointer-events: auto;
        }

        .product-modal__overlay {
            position: absolute;
            inset: 0;
        }

        .product-modal__content {
            position: relative;
            background: #fff;
            border-radius: 16px;
            width: min(100%, 960px);
            max-height: calc(100vh - 80px);
            overflow-y: auto;
            padding: 40px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
        }

        .product-modal__close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(0, 0, 0, 0.05);
            font-size: 22px;
            line-height: 1;
            cursor: pointer;
        }

        .product-modal__body {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .product-modal__body .product-upload,
        .product-modal__body .product-admin {
            margin-top: 0;
            box-shadow: none;
            padding: 0;
        }

        @media (max-width: 768px) {
            .product-modal {
                padding: 16px;
            }

            .product-modal__content {
                padding: 30px 20px;
            }

            .product-admin-toggle {
                width: 100%;
            }
        }

        /* Footer */
        footer {
            background: #2c3e50;
            color: white;
            padding: 60px 20px 30px;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-section h4 {
            font-size: 18px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .footer-section p {
            margin-bottom: 10px;
            line-height: 1.8;
            font-size: 14px;
        }

        .footer-section strong {
            display: inline-block;
            min-width: 120px;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 10px;
        }

        .footer-links a {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: #fe6b00;
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-links a {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: background 0.3s;
        }

        .social-links a:hover {
            background: #fe6b00;
        }

        .footer-bottom {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 20px;
            text-align: center;
            font-size: 14px;
        }

        .footer-bottom ul {
            list-style: none;
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .footer-bottom a {
            color: white;
            text-decoration: none;
        }

        .footer-bottom a:hover {
            text-decoration: underline;
        }

        .loading-message {
            grid-column: 1 / -1;
            text-align: center;
            color: #666;
            font-size: 16px;
        }

        @media (max-width: 768px) {
            .hero-content h1 {
                font-size: 32px;
            }

            .hero-content h2 {
                font-size: 24px;
            }

            nav ul {
                flex-direction: column;
                gap: 15px;
            }

            .section-title {
                font-size: 28px;
            }

            .products-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <a href="/" class="logo">MIJIN COSMETICS</a>
            <nav>
                <ul>
                    <li><a href="/about">ABOUT US</a></li>
                    <li><a href="/business">BUSINESS</a></li>
                    <li><a href="/19">PRODUCTION FACILITY</a></li>
                    <li><a href="/20">BRAND</a></li>
                    <li><a href="/21">CONTACT US</a></li>
                    <li><a href="https://mjcareshop.com/main/main.html">SHOP</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Hero Slider -->
    <div class="hero-slider">
        <div class="hero-content">
            <h1><strong>GLOBAL</strong></h1>
            <h2><strong>MIJIN COSMETICS</strong></h2>
            <p>ë¯¸ì§„í™”ì¥í’ˆì€ ì‹œíŠ¸ ë§ˆìŠ¤í¬íŒ© ì œì¡° ë° íŒë§¤,</p>
            <p>OEM/ODM ì „ë¬¸ê¸°ì—…ìœ¼ë¡œì„œ êµ­ë‚´ì™¸ ìœ í†µë§ì„ í†µí•´</p>
            <p>ì „ì„¸ê³„ì˜ ê³ ê°ë“¤ì—ê²Œ ë‹¤ê°€ê°€ê³  ìˆìŠµë‹ˆë‹¤.</p>
        </div>
    </div>

    <!-- About Section -->
    <section class="about-section">
        <div class="section-content">
            <h3>ìµœê³ ì˜ ì•„ë¦„ë‹¤ì›€ì„</h3>
            <h3>ì´ëŒì–´ë‚´ëŠ” ë¯¸ì§„í™”ì¥í’ˆ</h3>
            <p>MIJIN COSMETICS brings out the best beauty</p>
            <a href="/about" class="btn-more">more</a>
        </div>
    </section>

    <!-- Solutions Section -->
    <section class="solutions-section">
        <div class="solutions-content">
            <h3>íŠ¸ë Œë“œì— ë§ì¶˜</h3>
            <h3>ë§ì¶¤í˜• ì†”ë£¨ì…˜</h3>
            <p>Customized solutions for trends</p>
            <hr>
            <div class="certification">
                <strong>CPNP</strong> ì¸ì¦ ì·¨ë“
            </div>
            <hr>
            <div class="certification">
                <strong>CPNP</strong> ì¸ì¦ ì·¨ë“
            </div>
            <hr>
            <div class="certification">
                <strong>MIJIN COSMETICS</strong>
            </div>
            <hr>
        </div>
    </section>

    <!-- Products Section -->
    <section class="products-section">
        <h2 class="section-title">Monthly product</h2>
        <p class="section-subtitle">ìˆ˜ë¶„í¬ë¦¼ì„ ë“¬ë¿ ë°”ë¥¸ ë“¯í•œ ì‚¬ìš©ê°ì˜ í¬ë¦¼ ë§ˆìŠ¤í¬</p>
        <div class="products-grid" id="productsGrid" aria-live="polite">
            <p class="loading-message">ì œí’ˆ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
        </div>
        <div class="product-actions">
            <button type="button" class="product-admin-toggle" id="productModalOpen">ì œí’ˆ ì¶”ê°€ / ê´€ë¦¬</button>
        </div>
        <div class="product-modal" id="productModal" aria-hidden="true" role="dialog" aria-modal="true">
            <div class="product-modal__overlay" id="productModalOverlay"></div>
            <div class="product-modal__content" role="document">
                <button type="button" class="product-modal__close" id="productModalClose" aria-label="ì œí’ˆ ê´€ë¦¬ íŒì—… ë‹«ê¸°">&times;</button>
                <div class="product-modal__body">
                    <div class="product-upload">
                        <h3>ì œí’ˆ ì´ë¯¸ì§€ ì¶”ê°€</h3>
                        <form id="productUploadForm">
                            <label>
                                ì œí’ˆ ì´ë¯¸ì§€
                                <input type="file" id="productFile" accept="image/*" required>
                            </label>
                            <label>
                                ì œí’ˆëª… (ì„ íƒ)
                                <input type="text" id="productTitle" placeholder="ì˜ˆ: ì‹ ì œí’ˆ ë§ˆìŠ¤í¬íŒ©">
                            </label>
                            <label>
                                ë°°ì§€ (ì„ íƒ)
                                <input type="text" id="productBadge" placeholder="ì˜ˆ: BEST">
                            </label>
                            <label>
                                ê°€ê²© (ì„ íƒ)
                                <input type="text" id="productPrice" placeholder="ì˜ˆ: 2,000ì›">
                            </label>
                            <label>
                                ì„œë¸Œí…ìŠ¤íŠ¸ (ì„ íƒ)
                                <input type="text" id="productSubtitle" placeholder="ì˜ˆ: TIME SALE">
                            </label>
                            <button type="submit" id="uploadButton">ì´ë¯¸ì§€ ì¶”ê°€</button>
                        </form>
                        <p style="margin-top: 12px; font-size: 13px; color: #777;">â€» íŒŒì¼ëª…ì€ ìë™ìœ¼ë¡œ ì¹´ë“œ ì œëª©ì— ë°˜ì˜ë˜ë©°, ì…ë ¥í•œ ìƒì„¸ ì •ë³´ëŠ” ì´ë²ˆ ì„¸ì…˜ì—ì„œë§Œ í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>
                    <div class="product-admin">
                        <h3>ì œí’ˆ ê´€ë¦¬ (ìˆ˜ì • / ì‚­ì œ)</h3>
                        <div class="product-admin-list" id="productAdminList">
                            <p class="loading-message">ì œí’ˆ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>íšŒì‚¬ ì •ë³´</h4>
                    <p><strong>íšŒì‚¬ëª…</strong> (ì£¼)ë¯¸ì§„í™”ì¥í’ˆ</p>
                    <p><strong>ëŒ€í‘œì</strong> ì¥ì›í‘œ</p>
                    <p><strong>ì£¼ì†Œ</strong> ê²½ìƒë¶ë„ êµ¬ë¯¸ì‹œ 1ê³µë‹¨ë¡œ 6ê¸¸ 53-45</p>
                    <p><strong>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</strong> 264-81-51849</p>
                    <p><strong>í†µì‹ íŒë§¤ì—…ì‹ ê³  ë²ˆí˜¸</strong> ì œ2011-ê²½ë¶êµ¬ë¯¸-0026í˜¸</p>
                    <p><strong>ì´ë©”ì¼</strong> <a href="mailto:mijin_kor@mjcare.co.kr" style="color: #fe6b00;">mijin_kor@mjcare.co.kr</a></p>
                    <p style="margin-top: 20px;">COPYRIGHT MIJIN COSMETICS. ALL RIGHTS RESERVED.</p>
                </div>
                <div class="footer-section">
                    <h4>ë¹ ë¥¸ ë§í¬</h4>
                    <ul class="footer-links">
                        <li><a href="/about">ABOUT US</a></li>
                        <li><a href="/business">BUSINESS</a></li>
                        <li><a href="/19">PRODUCTION FACILITY</a></li>
                        <li><a href="/20">BRAND</a></li>
                        <li><a href="/21">CONTACT US</a></li>
                        <li><a href="https://mjcareshop.com/main/main.html">SHOP</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>CS CENTER</h4>
                    <p style="font-size: 24px; font-weight: bold; margin-bottom: 20px;">054.461.8081</p>
                    <p><strong>í‰ì¼</strong> 09:00 - 18:00</p>
                    <p><strong>ì ì‹¬ì‹œê°„</strong> 13:00 - 14:00</p>
                    <p><strong>íœ´ë¬´ì•ˆë‚´</strong> í† , ì¼, ê³µíœ´ì¼</p>
                    <p style="font-size: 12px; margin-top: 10px;">*ì£¼ë§ ë° ê³µíœ´ì¼ì—ëŠ” 1:1ë¬¸ì˜ë¡œ ë‚¨ê²¨ì£¼ì„¸ìš”</p>
                    <div class="social-links">
                        <a href="https://www.facebook.com/mijincare" title="Facebook">f</a>
                        <a href="https://www.instagram.com/mijincosmetics_official?igsh=OXQ0ZjA1dDdxOWZ1" title="Instagram">ğŸ“·</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <ul>
                    <li><a href="/?mode=policy">ì´ìš©ì•½ê´€</a></li>
                    <li><a href="/?mode=privacy">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
                </ul>
                <p>COPYRIGHT MIJIN COSMETICS. ALL RIGHTS RESERVED.</p>
            </div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        (function () {
            /**
             * TODO: ì•„ë˜ ìƒìˆ˜ë¥¼ ì‹¤ì œ í”„ë¡œì íŠ¸ ê°’ìœ¼ë¡œ êµì²´í•˜ì„¸ìš”.
             * anon keyëŠ” ê³µê°œ ì›¹ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ë¯¼ê°í•œ ì‘ì—…ì€ ë°±ì—”ë“œì—ì„œ ì²˜ë¦¬í•˜ê³ 
             * createSignedUrl í˜¸ì¶œ ì£¼ê¸°ë¥¼ ì¡°ì ˆí•˜ì—¬ í‚¤ ë…¸ì¶œì„ ìµœì†Œí™”í•˜ì„¸ìš”.
             */
            const SUPABASE_URL = 'https://nnieuiiisxecakiecjyp.supabase.co';
            const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5uaWV1aWlpc3hlY2FraWVjanlwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ0NDg4NTYsImV4cCI6MjA2MDAyNDg1Nn0.41jXCY2aj241ESJyJtRlUp11X37eK_9ArKF93r_HZrE';
            const SUPABASE_BUCKET = 'mjcare-image';
            const SUPABASE_FOLDER = 'home/home';
            const SIGNED_URL_TTL = 3600;
            const METADATA_STORAGE_KEY = 'mjcare-product-metadata';

            const PRODUCT_METADATA = loadStoredMetadata();

            const productsGrid = document.getElementById('productsGrid');
            const productAdminList = document.getElementById('productAdminList');
            const uploadForm = document.getElementById('productUploadForm');
            const fileInput = document.getElementById('productFile');
            const titleInput = document.getElementById('productTitle');
            const badgeInput = document.getElementById('productBadge');
            const priceInput = document.getElementById('productPrice');
            const subtitleInput = document.getElementById('productSubtitle');
            const uploadButton = document.getElementById('uploadButton');
            const productModal = document.getElementById('productModal');
            const productModalOpen = document.getElementById('productModalOpen');
            const productModalClose = document.getElementById('productModalClose');
            const productModalOverlay = document.getElementById('productModalOverlay');

            if (!productsGrid) {
                return;
            }

            const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            loadProducts();
            setupUploadForm();
            setupProductModal();

            async function loadProducts() {
                setStatus('ì œí’ˆ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...');

                const { data: files, error } = await supabaseClient
                    .storage
                    .from(SUPABASE_BUCKET)
                    .list(SUPABASE_FOLDER, {
                        limit: 50,
                        sortBy: { column: 'name', order: 'asc' }
                    });

                if (error) {
                    console.error(error);
                    setStatus('ì œí’ˆ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                    return;
                }

                if (!files || files.length === 0) {
                    setStatus('ë“±ë¡ëœ ì œí’ˆ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    renderAdminList([]);
                    return;
                }

                const cards = [];

                for (const file of files) {
                    if (file.name.startsWith('.')) continue;

                    const filePath = SUPABASE_FOLDER ? `${SUPABASE_FOLDER}/${file.name}` : file.name;
                    const { data: signedData, error: signedError } = await supabaseClient
                        .storage
                        .from(SUPABASE_BUCKET)
                        .createSignedUrl(filePath, SIGNED_URL_TTL);

                    if (signedError || !signedData?.signedUrl) {
                        console.error(signedError || 'Signed URL ìƒì„± ì‹¤íŒ¨');
                        continue;
                    }

                    const meta = PRODUCT_METADATA[file.name] || {};
                    cards.push({
                        fileName: file.name,
                        title: meta.title || formatFileName(file.name),
                        badge: meta.badge,
                        price: meta.price,
                        subtitle: meta.subtitle,
                        imageUrl: signedData.signedUrl,
                        meta
                    });
                }

                if (cards.length === 0) {
                    setStatus('í‘œì‹œí•  ìˆ˜ ìˆëŠ” ì œí’ˆ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    renderAdminList([]);
                    return;
                }

                renderProducts(cards);
                renderAdminList(cards);
            }

            function renderProducts(products) {
                productsGrid.innerHTML = '';
                products.forEach((product) => {
                    const card = document.createElement('div');
                    card.className = 'product-card';

                    const image = document.createElement('img');
                    image.className = 'product-image';
                    image.src = product.imageUrl;
                    image.alt = product.title;

                    const info = document.createElement('div');
                    info.className = 'product-info';

                    if (product.badge) {
                        const badge = document.createElement('span');
                        badge.className = 'product-badge';
                        badge.textContent = product.badge;
                        info.appendChild(badge);
                    }

                    const title = document.createElement('h3');
                    title.textContent = product.title;
                    info.appendChild(title);

                    if (product.price) {
                        const price = document.createElement('div');
                        price.className = 'product-price';
                        price.textContent = product.price;
                        info.appendChild(price);
                    }

                    if (product.subtitle) {
                        const subtitle = document.createElement('div');
                        subtitle.style.fontSize = '12px';
                        subtitle.style.color = '#999';
                        subtitle.style.marginTop = '5px';
                        subtitle.textContent = product.subtitle;
                        info.appendChild(subtitle);
                    }

                    card.appendChild(image);
                    card.appendChild(info);
                    productsGrid.appendChild(card);
                });
            }

            function renderAdminList(products) {
                if (!productAdminList) return;

                if (!products.length) {
                    productAdminList.innerHTML = '<p class="loading-message">ë“±ë¡ëœ ì œí’ˆ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }

                productAdminList.innerHTML = '';

                products.forEach((product) => {
                    const row = document.createElement('div');
                    row.className = 'product-admin-row';

                    const nameLabel = document.createElement('strong');
                    nameLabel.textContent = product.fileName;
                    row.appendChild(nameLabel);

                    const titleField = createMetaInput(product.meta?.title || '', 'ì œëª©');
                    const badgeField = createMetaInput(product.meta?.badge || '', 'ë°°ì§€');
                    const priceField = createMetaInput(product.meta?.price || '', 'ê°€ê²©');
                    const subtitleField = createMetaInput(product.meta?.subtitle || '', 'ì„œë¸Œí…ìŠ¤íŠ¸');

                    row.appendChild(titleField);
                    row.appendChild(badgeField);
                    row.appendChild(priceField);
                    row.appendChild(subtitleField);

                    const saveButton = document.createElement('button');
                    saveButton.type = 'button';
                    saveButton.className = 'btn-save-meta';
                    saveButton.textContent = 'ë©”íƒ€ ì €ì¥';
                    saveButton.addEventListener('click', async () => {
                        const meta = {};
                        if (titleField.value.trim()) meta.title = titleField.value.trim();
                        if (badgeField.value.trim()) meta.badge = badgeField.value.trim();
                        if (priceField.value.trim()) meta.price = priceField.value.trim();
                        if (subtitleField.value.trim()) meta.subtitle = subtitleField.value.trim();

                        if (Object.keys(meta).length === 0) {
                            delete PRODUCT_METADATA[product.fileName];
                        } else {
                            PRODUCT_METADATA[product.fileName] = meta;
                        }

                        saveStoredMetadata();
                        alert('ë©”íƒ€ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                        await loadProducts();
                    });

                    const deleteButton = document.createElement('button');
                    deleteButton.type = 'button';
                    deleteButton.className = 'btn-delete';
                    deleteButton.textContent = 'ì‚­ì œ';
                    deleteButton.addEventListener('click', async () => {
                        const confirmed = window.confirm('ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
                        if (!confirmed) return;

                        toggleRowButtons(deleteButton, saveButton, true);

                        const filePath = SUPABASE_FOLDER ? `${SUPABASE_FOLDER}/${product.fileName}` : product.fileName;
                        const { error } = await supabaseClient
                            .storage
                            .from(SUPABASE_BUCKET)
                            .remove([filePath]);

                        if (error) {
                            console.error(error);
                            alert('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì½˜ì†” ë¡œê·¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
                            toggleRowButtons(deleteButton, saveButton, false);
                            return;
                        }

                        delete PRODUCT_METADATA[product.fileName];
                        saveStoredMetadata();
                        alert('ì‚­ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                        toggleRowButtons(deleteButton, saveButton, false);
                        await loadProducts();
                    });

                    row.appendChild(saveButton);
                    row.appendChild(deleteButton);
                    productAdminList.appendChild(row);
                });
            }

            function createMetaInput(value, placeholder) {
                const input = document.createElement('input');
                input.type = 'text';
                input.placeholder = placeholder;
                input.value = value;
                return input;
            }

            function setStatus(message) {
                productsGrid.innerHTML = `<p class="loading-message">${message}</p>`;
            }

            function formatFileName(filename) {
                return filename
                    .replace(/\.[^/.]+$/, '')
                    .replace(/[_-]+/g, ' ')
                    .trim();
            }

            function loadStoredMetadata() {
                try {
                    const raw = window.localStorage.getItem(METADATA_STORAGE_KEY);
                    return raw ? JSON.parse(raw) : {};
                } catch (error) {
                    console.warn('ë©”íƒ€ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨', error);
                    return {};
                }
            }

            function saveStoredMetadata() {
                try {
                    window.localStorage.setItem(METADATA_STORAGE_KEY, JSON.stringify(PRODUCT_METADATA));
                } catch (error) {
                    console.warn('ë©”íƒ€ë°ì´í„° ì €ì¥ ì‹¤íŒ¨', error);
                }
            }

            function setupUploadForm() {
                if (!uploadForm || !fileInput) return;

                uploadForm.addEventListener('submit', async (event) => {
                    event.preventDefault();
                    if (!fileInput.files?.length) {
                        alert('ì—…ë¡œë“œí•  ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                        return;
                    }

                    const file = fileInput.files[0];
                    const sanitizedName = `${Date.now()}-${file.name}`.replace(/\s+/g, '-');
                    const storagePath = SUPABASE_FOLDER ? `${SUPABASE_FOLDER}/${sanitizedName}` : sanitizedName;

                    toggleUploadButton(true, 'ì—…ë¡œë“œ ì¤‘...');

                    const { error } = await supabaseClient
                        .storage
                        .from(SUPABASE_BUCKET)
                        .upload(storagePath, file, {
                            cacheControl: '3600',
                            upsert: false
                        });

                    if (error) {
                        console.error(error);
                        alert('ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì½˜ì†” ë¡œê·¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
                        toggleUploadButton(false);
                        return;
                    }

                    const meta = {};
                    if (titleInput?.value.trim()) meta.title = titleInput.value.trim();
                    if (badgeInput?.value.trim()) meta.badge = badgeInput.value.trim();
                    if (priceInput?.value.trim()) meta.price = priceInput.value.trim();
                    if (subtitleInput?.value.trim()) meta.subtitle = subtitleInput.value.trim();

                    if (Object.keys(meta).length > 0) {
                        PRODUCT_METADATA[sanitizedName] = meta;
                        saveStoredMetadata();
                    }

                    uploadForm.reset();
                    alert('ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ëª©ë¡ì„ ìƒˆë¡œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.');
                    toggleUploadButton(false);
                    await loadProducts();
                });
            }

            function toggleUploadButton(disabled, text) {
                if (!uploadButton) return;
                uploadButton.disabled = disabled;
                uploadButton.textContent = text || 'ì´ë¯¸ì§€ ì¶”ê°€';
            }

            function toggleRowButtons(deleteButton, saveButton, disabled) {
                deleteButton.disabled = disabled;
                saveButton.disabled = disabled;
                deleteButton.textContent = disabled ? 'ì‚­ì œ ì¤‘...' : 'ì‚­ì œ';
                if (disabled) {
                    saveButton.dataset.originalText = saveButton.textContent;
                    saveButton.textContent = 'ì²˜ë¦¬ ì¤‘...';
                } else if (saveButton.dataset.originalText) {
                    saveButton.textContent = saveButton.dataset.originalText;
                    delete saveButton.dataset.originalText;
                }
            }

            function setupProductModal() {
                if (!productModal || !productModalOpen) return;

                let previousBodyOverflow = '';

                const openModal = () => {
                    previousBodyOverflow = document.body.style.overflow || '';
                    document.body.style.overflow = 'hidden';
                    productModal.classList.add('is-active');
                    productModal.setAttribute('aria-hidden', 'false');
                    productModalClose?.focus();
                };

                const closeModal = () => {
                    productModal.classList.remove('is-active');
                    productModal.setAttribute('aria-hidden', 'true');
                    document.body.style.overflow = previousBodyOverflow;
                };

                const handleKeydown = (event) => {
                    if (event.key === 'Escape' && productModal.classList.contains('is-active')) {
                        closeModal();
                    }
                };

                productModalOpen.addEventListener('click', openModal);
                productModalClose?.addEventListener('click', closeModal);
                productModalOverlay?.addEventListener('click', closeModal);
                document.addEventListener('keydown', handleKeydown);
            }
        })();
    </script>
</body>
</html>






